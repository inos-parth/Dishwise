{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useParams,useNavigate}from'react-router-dom';import'./MenuPage.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const MenuPage=()=>{const{placeId}=useParams();const navigate=useNavigate();const[menuData,setMenuData]=useState([]);const[restaurant,setRestaurant]=useState(null);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);useEffect(()=>{const fetchMenu=async()=>{try{const response=await fetch(`http://localhost:8000/api/restaurants/menu/${placeId}`);const data=await response.json();if(response.ok&&data.menu){setMenuData(data.menu.map(item=>({...item,userRating:0,userReview:''})));setRestaurant(data.restaurant);}else{setError(data.message||'Menu not available');}}catch(error){console.error('Error fetching menu:',error);setError('Failed to load menu');}finally{setLoading(false);}};fetchMenu();},[placeId]);const handleRatingChange=(dishIndex,rating)=>{const updatedMenu=[...menuData];updatedMenu[dishIndex].userRating=rating;setMenuData(updatedMenu);};const handleReviewChange=(dishIndex,review)=>{const updatedMenu=[...menuData];updatedMenu[dishIndex].userReview=review;setMenuData(updatedMenu);};const submitReview=async dishIndex=>{const dish=menuData[dishIndex];if(dish.userRating===0){alert('Please provide a rating before submitting');return;}try{const response=await fetch('http://localhost:8000/api/reviews',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({dishName:dish.name,placeId:placeId,rating:dish.userRating,review:dish.userReview||null})});const data=await response.json();if(response.ok){alert('Review submitted successfully!');const updatedMenu=[...menuData];updatedMenu[dishIndex].averageRating=data.averageRating;updatedMenu[dishIndex].totalReviews=data.totalReviews;setMenuData(updatedMenu);}else{alert(data.message||'Failed to submit review');}}catch(error){console.error('Error submitting review:',error);alert('Error submitting review');}};return/*#__PURE__*/_jsxs(\"div\",{className:\"menu-page\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"menu-header\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>navigate(-1),className:\"back-button\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-arrow-left\"}),\" Back to Results\"]}),/*#__PURE__*/_jsxs(\"h1\",{children:[(restaurant===null||restaurant===void 0?void 0:restaurant.name)||'Restaurant',\" Menu\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"menu-content\",children:[loading&&/*#__PURE__*/_jsx(\"div\",{className:\"loading\",children:\"Loading menu...\"}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"error-message\",children:error}),menuData.map((item,index)=>{var _item$averageRating;return/*#__PURE__*/_jsxs(\"div\",{className:\"menu-item\",children:[/*#__PURE__*/_jsx(\"img\",{src:`https://via.placeholder.com/150?text=${encodeURIComponent(item.name)}`,alt:item.name,className:\"menu-item-image\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"item-info\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"item-details\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"item-name\",children:item.name}),/*#__PURE__*/_jsxs(\"span\",{className:\"item-price\",children:[\"$\",item.price]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"item-rating\",children:[[1,2,3,4,5].map(star=>/*#__PURE__*/_jsx(\"i\",{className:`fas fa-star ${star<=item.userRating?'selected':''}`,onMouseEnter:()=>handleRatingChange(index,star),onMouseLeave:()=>!item.userRating?handleRatingChange(index,0):null,onClick:()=>handleRatingChange(index,star)},star)),/*#__PURE__*/_jsxs(\"span\",{className:\"rating-text\",children:[\"(\",((_item$averageRating=item.averageRating)===null||_item$averageRating===void 0?void 0:_item$averageRating.toFixed(1))||0,\" / \",item.totalReviews||0,\" reviews)\"]})]}),/*#__PURE__*/_jsx(\"textarea\",{placeholder:\"Write a review (optional)...\",value:item.userReview,onChange:e=>handleReviewChange(index,e.target.value),className:\"review-textarea\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>submitReview(index),className:\"submit-review-button\",children:\"Submit Review\"})]})]},index);})]})]});};export default MenuPage;","map":{"version":3,"names":["React","useState","useEffect","useParams","useNavigate","jsx","_jsx","jsxs","_jsxs","MenuPage","placeId","navigate","menuData","setMenuData","restaurant","setRestaurant","loading","setLoading","error","setError","fetchMenu","response","fetch","data","json","ok","menu","map","item","userRating","userReview","message","console","handleRatingChange","dishIndex","rating","updatedMenu","handleReviewChange","review","submitReview","dish","alert","method","headers","body","JSON","stringify","dishName","name","averageRating","totalReviews","className","children","onClick","index","_item$averageRating","src","encodeURIComponent","alt","price","star","onMouseEnter","onMouseLeave","toFixed","placeholder","value","onChange","e","target"],"sources":["/Users/parthsoni/Desktop/dishwise/client/src/pages/MenuPage.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport './MenuPage.css';\n\nconst MenuPage = () => {\n  const { placeId } = useParams();\n  const navigate = useNavigate();\n  const [menuData, setMenuData] = useState([]);\n  const [restaurant, setRestaurant] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  useEffect(() => {\n    const fetchMenu = async () => {\n      try {\n        const response = await fetch(`http://localhost:8000/api/restaurants/menu/${placeId}`);\n        const data = await response.json();\n\n        if (response.ok && data.menu) {\n          setMenuData(data.menu.map((item) => ({\n            ...item,\n            userRating: 0,\n            userReview: '',\n          })));\n          setRestaurant(data.restaurant);\n        } else {\n          setError(data.message || 'Menu not available');\n        }\n      } catch (error) {\n        console.error('Error fetching menu:', error);\n        setError('Failed to load menu');\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchMenu();\n  }, [placeId]);\n\n  const handleRatingChange = (dishIndex, rating) => {\n    const updatedMenu = [...menuData];\n    updatedMenu[dishIndex].userRating = rating;\n    setMenuData(updatedMenu);\n  };\n\n  const handleReviewChange = (dishIndex, review) => {\n    const updatedMenu = [...menuData];\n    updatedMenu[dishIndex].userReview = review;\n    setMenuData(updatedMenu);\n  };\n\n  const submitReview = async (dishIndex) => {\n    const dish = menuData[dishIndex];\n    if (dish.userRating === 0) {\n      alert('Please provide a rating before submitting');\n      return;\n    }\n\n    try {\n      const response = await fetch('http://localhost:8000/api/reviews', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          dishName: dish.name,\n          placeId: placeId,\n          rating: dish.userRating,\n          review: dish.userReview || null,\n        }),\n      });\n\n      const data = await response.json();\n      if (response.ok) {\n        alert('Review submitted successfully!');\n        const updatedMenu = [...menuData];\n        updatedMenu[dishIndex].averageRating = data.averageRating;\n        updatedMenu[dishIndex].totalReviews = data.totalReviews;\n        setMenuData(updatedMenu);\n      } else {\n        alert(data.message || 'Failed to submit review');\n      }\n    } catch (error) {\n      console.error('Error submitting review:', error);\n      alert('Error submitting review');\n    }\n  };\n\n  return (\n    <div className=\"menu-page\">\n      <div className=\"menu-header\">\n        <button onClick={() => navigate(-1)} className=\"back-button\">\n          <i className=\"fas fa-arrow-left\"></i> Back to Results\n        </button>\n        <h1>{restaurant?.name || 'Restaurant'} Menu</h1>\n      </div>\n\n      <div className=\"menu-content\">\n        {loading && <div className=\"loading\">Loading menu...</div>}\n        {error && <div className=\"error-message\">{error}</div>}\n\n        {menuData.map((item, index) => (\n          <div key={index} className=\"menu-item\">\n            <img\n              src={`https://via.placeholder.com/150?text=${encodeURIComponent(item.name)}`}\n              alt={item.name}\n              className=\"menu-item-image\"\n            />\n            <div className=\"item-info\">\n              <div className=\"item-details\">\n                <span className=\"item-name\">{item.name}</span>\n                <span className=\"item-price\">${item.price}</span>\n              </div>\n              <div className=\"item-rating\">\n                {[1, 2, 3, 4, 5].map((star) => (\n                  <i\n                    key={star}\n                    className={`fas fa-star ${star <= item.userRating ? 'selected' : ''}`}\n                    onMouseEnter={() => handleRatingChange(index, star)}\n                    onMouseLeave={() =>\n                      !item.userRating ? handleRatingChange(index, 0) : null\n                    }\n                    onClick={() => handleRatingChange(index, star)}\n                  ></i>\n                ))}\n                <span className=\"rating-text\">\n                  ({item.averageRating?.toFixed(1) || 0} / {item.totalReviews || 0} reviews)\n                </span>\n              </div>\n              <textarea\n                placeholder=\"Write a review (optional)...\"\n                value={item.userReview}\n                onChange={(e) => handleReviewChange(index, e.target.value)}\n                className=\"review-textarea\"\n              ></textarea>\n              <button\n                onClick={() => submitReview(index)}\n                className=\"submit-review-button\"\n              >\n                Submit Review\n              </button>\n            </div>\n          </div>\n        ))}\n      </div>\n    </div>\n  );\n};\n\nexport default MenuPage;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}