{"ast":null,"code":"// src/hooks/useGoogleMap.js\nimport{useState,useCallback,useRef,useEffect}from'react';export const useGoogleMap=searchLocation=>{const[restaurants,setRestaurants]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const markersRef=useRef([]);const mapRef=useRef(null);const clearMarkers=()=>{if(markersRef.current){markersRef.current.forEach(marker=>marker.setMap(null));markersRef.current=[];}};const initMap=useCallback(async function(){let filters=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};if(!window.google){throw new Error(\"Google Maps not loaded\");}try{var _searchLocation$coord,_searchLocation$coord2;clearMarkers();if(!(searchLocation!==null&&searchLocation!==void 0&&(_searchLocation$coord=searchLocation.coordinates)!==null&&_searchLocation$coord!==void 0&&_searchLocation$coord.lat)||!(searchLocation!==null&&searchLocation!==void 0&&(_searchLocation$coord2=searchLocation.coordinates)!==null&&_searchLocation$coord2!==void 0&&_searchLocation$coord2.lng)){throw new Error(\"Invalid location coordinates\");}const coordinates=new window.google.maps.LatLng(searchLocation.coordinates.lat,searchLocation.coordinates.lng);mapRef.current=new window.google.maps.Map(document.getElementById(\"map\"),{center:coordinates,zoom:14,mapId:\"3d323ae4d3f413fd\"});const service=new window.google.maps.places.PlacesService(mapRef.current);const request={location:coordinates,keyword:`food ${filters.cuisine||\"\"}`.trim(),rankBy:window.google.maps.places.RankBy.DISTANCE};if(filters.openNow){request.openNow=true;}const results=await new Promise((resolve,reject)=>{service.nearbySearch(request,(results,status)=>{if(status===window.google.maps.places.PlacesServiceStatus.OK){resolve(results);}else{reject(new Error(`Places API error: ${status}`));}});});// Filter results by minimum rating (if specified)\nconst filteredResults=filters.minRating?results.filter(place=>place.rating>=filters.minRating):results;const sortedResults=filters.minRating?filteredResults.sort((a,b)=>b.rating-a.rating):filteredResults;// Add markers for sorted results\nsortedResults.forEach(place=>{var _place$geometry;if((_place$geometry=place.geometry)!==null&&_place$geometry!==void 0&&_place$geometry.location){const marker=new window.google.maps.Marker({position:place.geometry.location,map:mapRef.current,title:place.name});const infowindow=new window.google.maps.InfoWindow({content:`\n                            <div>\n                                <h3>${place.name}</h3>\n                                <p>${place.vicinity}</p>\n                                <p>${place.rating?`${place.rating} ⭐`:\"No rating\"}</p>\n                            </div>\n                        `});marker.addListener(\"click\",()=>{infowindow.open(mapRef.current,marker);});markersRef.current.push(marker);}});// Update restaurants state\nsetRestaurants(sortedResults);setLoading(false);}catch(err){setError(err.message);setLoading(false);throw err;}},[searchLocation]);// Cleanup on unmount\nuseEffect(()=>{return()=>{clearMarkers();};},[]);return{restaurants,loading,error,initMap};};","map":{"version":3,"names":["useState","useCallback","useRef","useEffect","useGoogleMap","searchLocation","restaurants","setRestaurants","loading","setLoading","error","setError","markersRef","mapRef","clearMarkers","current","forEach","marker","setMap","initMap","filters","arguments","length","undefined","window","google","Error","_searchLocation$coord","_searchLocation$coord2","coordinates","lat","lng","maps","LatLng","Map","document","getElementById","center","zoom","mapId","service","places","PlacesService","request","location","keyword","cuisine","trim","rankBy","RankBy","DISTANCE","openNow","results","Promise","resolve","reject","nearbySearch","status","PlacesServiceStatus","OK","filteredResults","minRating","filter","place","rating","sortedResults","sort","a","b","_place$geometry","geometry","Marker","position","map","title","name","infowindow","InfoWindow","content","vicinity","addListener","open","push","err","message"],"sources":["/Users/parthsoni/Desktop/dishwise/client/src/hooks/useGoogleMaps.js"],"sourcesContent":["// src/hooks/useGoogleMap.js\nimport { useState, useCallback, useRef, useEffect } from 'react';\n\nexport const useGoogleMap = (searchLocation) => {\n    const [restaurants, setRestaurants] = useState([]);\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState(null);\n    const markersRef = useRef([]);\n    const mapRef = useRef(null);\n\n    const clearMarkers = () => {\n        if (markersRef.current) {\n            markersRef.current.forEach(marker => marker.setMap(null));\n            markersRef.current = [];\n        }\n    };\n\n    const initMap = useCallback(\n        async (filters = {}) => {\n            if (!window.google) {\n                throw new Error(\"Google Maps not loaded\");\n            }\n\n            try {\n                clearMarkers();\n\n                if (!searchLocation?.coordinates?.lat || !searchLocation?.coordinates?.lng) {\n                    throw new Error(\"Invalid location coordinates\");\n                }\n\n                const coordinates = new window.google.maps.LatLng(\n                    searchLocation.coordinates.lat,\n                    searchLocation.coordinates.lng\n                );\n\n                mapRef.current = new window.google.maps.Map(document.getElementById(\"map\"), {\n                    center: coordinates,\n                    zoom: 14,\n                    mapId: \"3d323ae4d3f413fd\",\n                });\n\n                const service = new window.google.maps.places.PlacesService(mapRef.current);\n\n                const request = {\n                    location: coordinates,\n                    keyword: `food ${filters.cuisine || \"\"}`.trim(),\n                    rankBy: window.google.maps.places.RankBy.DISTANCE,\n                };\n\n                if (filters.openNow) {\n                    request.openNow = true;\n                }\n\n                const results = await new Promise((resolve, reject) => {\n                    service.nearbySearch(request, (results, status) => {\n                        if (status === window.google.maps.places.PlacesServiceStatus.OK) {\n                            resolve(results);\n                        } else {\n                            reject(new Error(`Places API error: ${status}`));\n                        }\n                    });\n                });\n\n                // Filter results by minimum rating (if specified)\n                const filteredResults = filters.minRating\n                    ? results.filter((place) => place.rating >= filters.minRating)\n                    : results;\n\n                const sortedResults = filters.minRating\n                    ? filteredResults.sort((a, b) => b.rating - a.rating)\n                    : filteredResults;\n\n                // Add markers for sorted results\n                sortedResults.forEach((place) => {\n                    if (place.geometry?.location) {\n                        const marker = new window.google.maps.Marker({\n                            position: place.geometry.location,\n                            map: mapRef.current,\n                            title: place.name,\n                        });\n\n                        const infowindow = new window.google.maps.InfoWindow({\n                            content: `\n                            <div>\n                                <h3>${place.name}</h3>\n                                <p>${place.vicinity}</p>\n                                <p>${place.rating ? `${place.rating} ⭐` : \"No rating\"}</p>\n                            </div>\n                        `,\n                        });\n\n                        marker.addListener(\"click\", () => {\n                            infowindow.open(mapRef.current, marker);\n                        });\n\n                        markersRef.current.push(marker);\n                    }\n                });\n\n                // Update restaurants state\n                setRestaurants(sortedResults);\n                setLoading(false);\n            } catch (err) {\n                setError(err.message);\n                setLoading(false);\n                throw err;\n            }\n        },\n        [searchLocation]\n    );\n\n\n\n    // Cleanup on unmount\n    useEffect(() => {\n        return () => {\n            clearMarkers();\n        };\n    }, []);\n\n    return { restaurants, loading, error, initMap };\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}